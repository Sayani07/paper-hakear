---
title: "Mean of normal distribution"
author: "Sayani Gupta"
date: "25/08/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(ggpubr)
```


```{r functions}
# create data for each levels
set.seed(12345)
create_simdata <- function(nx = 2, nsim = 5, sim_dist = distributional::dist_gamma(0.5, 3)){
  mean_dist <- (1:nsim) %>% 
  purrr::map(function(i){
    #x =  rgamma(nx, 0.5, 3)
    x =  sim_dist %>% distributional::generate(nx) %>% unlist()
    p = 1-(1/nx)
    b = stats::qnorm(p, mean(x), sd(x))
    a = 1/(nx*stats::dnorm(b, mean(x), sd(x)))
    k = stats::quantile(x, p, type = 8, na.rm = TRUE)
    (max(x)-a)/b
    # max(x)
  })
}
```


```{r tidy_data}

nlevels = seq(60, 100, 5)

data_orig <- nlevels %>% 
  purrr::map_df(function(i){
    create_datai <- create_simdata(nx = i, nsim = 500)
    tibble::tibble(ind = i, sim_data = create_datai)
  })

data_orig %>%
  unnest(sim_data) %>% 
   ggplot(aes(x = sim_data)) +
  geom_histogram() +
  facet_wrap(~ind)


```

