---
title: "Threshold computation"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

 1. Given the original sequence for all harmony pairs; $\{v_t: t=0, 1, 2, \dots, T-1\}$, the $MMPD$ is computed for all harmony pairs and is represented by the vector $MMPD_{obs}$, each element of the vector corresponding to the $MMPD$ of each harmony pair.
 2. From the original sequence a random permutation is obtained: $\{v_t^*: t=0, 1, 2, \dots, T-1\}$.
 3. MMPD is computed for all harmony pairs for this permutation and is represented by the vector $MMPD_{sample}$.
 4. Steps (2) and (3) are repeated a large number of times M (e.g. 1000).
 5. For each permutation, one $MMPD_{sample}$ vector is obtained.
 6. $95^{th}$ percentile of all elements of the $MMPD_{sample}$ from different permutations is computed and stored in $MMPD_{threshold}$.
 7. Harmony pairs for which $MMPD_{obs} > MMPD_{threshold}$ are chosen.